---
import { getCollection } from 'astro:content';
import type { GetStaticPaths } from 'astro';
import Layout from '../../layouts/Layout.astro';

export const getStaticPaths: GetStaticPaths = async () => {
  const newsEntries = await getCollection('news');
  return newsEntries.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
};

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<Layout title={`${entry.data.title} - Drip Drip Tamar`}>
  <main class="max-w-4xl mx-auto px-4 py-8">
    <nav class="mb-8">
      <a href="/news/" class="text-primary hover:underline text-sm font-medium">
        ← Back to News
      </a>
    </nav>

    <article>
      <header class="mb-8">
        <div class="flex items-center gap-2 text-sm text-gray-500 mb-4">
          <time datetime={entry.data.date.toISOString()}>
            {entry.data.date.toLocaleDateString('en-GB', {
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            })}
          </time>
          <span class="text-gray-300">•</span>
          <span>{entry.data.author}</span>
          {entry.data.featured && (
            <>
              <span class="text-gray-300">•</span>
              <span class="chip chip-primary">Featured</span>
            </>
          )}
        </div>
        
        <h1 class="text-4xl font-bold tracking-tight text-gray-900 mb-4">
          {entry.data.title}
        </h1>
        
        <p class="text-xl text-gray-600 mb-6">
          {entry.data.summary}
        </p>

        {entry.data.tags.length > 0 && (
          <div class="flex flex-wrap gap-2">
            {entry.data.tags.map((tag) => (
              <span class="chip">{tag}</span>
            ))}
          </div>
        )}
      </header>

      <div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-a:text-primary prose-a:no-underline hover:prose-a:underline">
        <Content />
      </div>
    </article>

    <footer class="mt-12 pt-8 border-t border-gray-200">
      <div class="text-center">
        <p class="text-gray-600 mb-4">
          Questions about water quality monitoring?
        </p>
        <a href="/contact/" class="btn">Get in Touch</a>
      </div>
    </footer>
  </main>
</Layout>